DelegatedAccount (Fork Tests)
├── initialize
│   └── when all parameters are valid
│       ├── it should set the owner.
│       ├── it should set the operator.
│       ├── it should set the exchange.
│       ├── it should set the collateralToken.
│       ├── it should give infinite approval to exchange.
│       └── it should initialize operator allowlist with default selectors.
├── createAccount
│   ├── when caller is not owner
│   │   └── it should revert with OwnableUnauthorizedAccount.
│   ├── when account already exists
│   │   └── it should revert with AccountAlreadyCreated.
│   ├── when exchange call fails
│   │   └── it should bubble up the Exchange error.
│   └── when account does not exist
│       └── it should store the accountId from exchange.
├── transferOwnership (two-step)
│   ├── when caller is not owner
│   │   └── it should revert with OwnableUnauthorizedAccount.
│   └── when newOwner is valid
│       ├── it should set pendingOwner.
│       ├── it should emit OwnershipTransferStarted event.
│       └── when pending owner accepts
│           ├── it should transfer ownership.
│           └── it should clear pendingOwner.
├── addOperator
│   ├── when caller is not owner
│   │   └── it should revert with OwnableUnauthorizedAccount.
│   ├── when operator is zero address
│   │   └── it should revert with ZeroAddress.
│   └── when caller is owner
│       ├── it should add operator to mapping.
│       └── it should emit OperatorAdded event.
├── removeOperator
│   ├── when caller is not owner
│   │   └── it should revert with OwnableUnauthorizedAccount.
│   └── when caller is owner
│       ├── it should remove operator from mapping.
│       └── it should emit OperatorRemoved event.
├── isOperator
│   ├── when address is an operator
│   │   └── it should return true.
│   └── when address is not an operator
│       └── it should return false.
├── setOperatorAllowlist
│   ├── when caller is not owner
│   │   └── it should revert with OwnableUnauthorizedAccount.
│   └── when adding a selector
│       ├── it should update allowlist.
│       └── it should emit OperatorAllowlistUpdated event.
├── fallback
│   ├── when caller is not owner or operator
│   │   └── it should revert with OnlyOwnerOrOperator.
│   ├── when caller is operator
│   │   ├── when account does not exist
│   │   │   └── it should revert with AccountNotCreated.
│   │   ├── when selector is not allowlisted (e.g. xferAcctToProtocol)
│   │   │   └── it should revert with SelectorNotAllowed.
│   │   └── when selector is allowlisted
│   │       └── it should forward the call to exchange.
│   └── when caller is owner
│       └── it should forward any call to exchange.
├── withdrawCollateral
│   └── when caller is not owner
│       └── it should revert with OwnableUnauthorizedAccount.
├── rescueTokens
│   ├── when caller is not owner
│   │   └── it should revert with OwnableUnauthorizedAccount.
│   └── when caller is owner
│       └── it should transfer tokens to owner.
├── isOperatorAllowed
│   ├── when selector is allowlisted
│   │   └── it should return true.
│   └── when selector is not allowlisted
│       └── it should return false.
└── exchange operations (via fallback)
    ├── depositCollateral
    │   ├── when caller is owner
    │   │   └── it should increase account balance on exchange.
    │   └── when caller is operator
    │       └── it should increase account balance on exchange (allowlisted).
    ├── allowOrderForwarding
    │   ├── when caller is owner (enable)
    │   │   └── it should succeed.
    │   ├── when caller is owner (disable)
    │   │   └── it should succeed.
    │   └── when caller is operator
    │       └── it should succeed (allowlisted).
    └── execOrder
        ├── when caller is owner
        │   └── it should create order on exchange.
        └── when caller is operator
            └── it should create order on exchange (allowlisted).
